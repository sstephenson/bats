.\" generated with Ronn/v0.7.3
.\" http://github.com/rtomayko/ronn/tree/0.7.3
.
.TH "BATSLIB" "7" "September 2015" "" ""
.
.SH "NAME"
\fBbatslib\fR \- Bats Standard Library of Test Helpers
.
.SH "DESCRIPTION"
The Standard Library is a collection of test helpers intended to simplify testing\. It helps building test suits that provide relevant information when a test fails to speed up debugging\.
.
.P
It contains the following types of test helpers\.
.
.IP "\(bu" 4
\fIASSERTIONS\fR are functions that perform a test and output relevant information on failure to help debugging\.
.
.IP "" 0
.
.P
Test helpers send all output to the standard error, making them usable outside of \fB@test\fR functions too\. Output is formatted for readability as described in \fIOUTPUT\fR\.
.
.P
The Standard Library is automatically loaded and available in all test files\.
.
.SH "OUTPUT"
On failure, in addition to the usual output generated by Bats, \fIASSERTIONS\fR display information relevant to the failed test to help debugging\. The output is formatted for readability and displayed as key\-value pairs on the standard error\.
.
.P
When the value is one line long, the pair is displayed in a columnar fashion called \fBtwo\-column\fR format\.
.
.IP "" 4
.
.nf

\-\- output differs \-\-
expected : want
actual   : have
\-\-
.
.fi
.
.IP "" 0
.
.P
When the value is longer than one line, the number of lines in the value is displayed after the key, and the value starts on the next line and is indented by two spaces for added readability\. This is called \fBmulti\-line\fR format\.
.
.P
For convenience, sometimes related values are also displayed in this format even if they are only one line long\.
.
.IP "" 4
.
.nf

\-\- output differs \-\-
expected (1 lines):
  want
actual (3 lines):
  have 1
  have 2
  have 3
\-\-
.
.fi
.
.IP "" 0
.
.SH "ASSERTIONS"
Assertions are functions that perform a test and output relevant information on failure to help debugging\. They return 1 on failure and 0 otherwise\.
.
.P
Assertions about exit code and output operate on the results of the most recent invocation of \fBrun\fR\.
.
.TP
\fBflunk\fR [\fIMESSAGE\fR]
Display \fIMESSAGE\fR and fail\. This function provides a convenient way to report various failures\. Other test helpers also use it to display output on failure\. When no parameters are specified, \fIMESSAGE\fR is read from the standard input\.
.
.TP
\fBassert\fR \fIEXPRESSION\fR
Fail if \fIEXPRESSION\fR evaluates to false\. On failure, \fIEXPRESSION\fR is displayed\.
.
.IP
\fBNote:\fR \fIEXPRESSION\fR can only be a simple command\. Compound commands, such as \fB[[\fR, are not supported\.
.
.TP
\fBassert_equal\fR \fIEXPECTED\fR \fIACTUAL\fR
Fail if \fIEXPECTED\fR and \fIACTUAL\fR do not equal\. On failure both values are displayed\. If either one is longer than one line, both are displayed in \fImulit\-line\fR format\.
.
.TP
\fBassert_output\fR [\-l \fIINDEX\fR|\-L] [\-p|\-r] [\fIEXPECTED\fR]
Fail if \fIEXPECTED\fR does not equal \fB$output\fR\. On failure both values are displayed\. If either one is longer than one line, both are displayed in \fImulit\-line\fR format\. When no parameters are specified, \fIEXPECTED\fR is read from the standard input\.
.
.IP
When \fB\-l\fR is used, fail if \fIEXPECTED\fR does not equal the \fIINDEX\fR\-th element of \fB${lines[@]}\fR\. On failure, \fIINDEX\fR, \fIEXPECTED\fR and the actual line are displayed\.
.
.IP
When \fB\-L\fR is used, fail if \fIEXPECTED\fR is not found in \fB${lines[@]}\fR\. On failure, \fIEXPECTED\fR and \fB$output\fR are displayed\. If \fB$output\fR is longer than one line, it is displayed in \fImulit\-line\fR format\.
.
.IP
The default, literal matching can be changed to substring and regular expression matching\.
.
.IP
Using \fB\-p\fR enables partial matching, and the assertion fails if \fIEXPECTED\fR as a substring is not found in the output\.
.
.IP
Using \fB\-r\fR enables regular expression matching, and the assertion fails if \fIEXPECTED\fR as an extended regular expression does not match the output\.
.
.IP
\fBNOTE:\fR Due to a bug in Bats, empty lines are discarded from \fB${lines[@]}\fR, causing line indices to change and preventing testing for empty lines\. See \fIBUGS\fR for more\.
.
.TP
\fBrefute_output\fR [\-l \fIINDEX\fR|\-L] [\-p|\-r] [\fIUNEXPECTED\fR]
Fail if \fIUNEXPECTED\fR equals \fB$output\fR\. On failure, \fB$output\fR is displayed\. If \fB$output\fR is longer than one line, it is displayed in \fImulti\-line\fR format\. When no parameters are specified, \fIUNEXPECTED\fR is read from the standard input\.
.
.IP
When \fB\-l\fR is used, fail if \fIUNEXPECTED\fR equals the \fIINDEX\fR\-th element of \fB${lines[@]}\fR\. On failure, \fIINDEX\fR and \fIUNEXPECTED\fR are displayed\.
.
.IP
When \fB\-L\fR is used, fail if \fIUNEXPECTED\fR is found in \fB${lines[@]}\fR\. On failure, \fIUNEXPECTED\fR, its index in \fB${lines[@]}\fR and \fB$output\fR are displayed\. If \fB$output\fR is longer than one line, it is displayed in \fImulti\-line\fR format with the unexpected line highlighted\.
.
.IP
The default, literal matching can be changed to substring and regular expression matching\.
.
.IP
Using \fB\-p\fR enables partial matching, and the assertion fails if \fIUNEXPECTED\fR as a substring is found in the output\. On failure, \fIUNEXPECTED\fR is displayed in addition\.
.
.IP
Using \fB\-r\fR enables regular expression matching, and the assertion fails if \fIUNEXPECTED\fR as an extended regular expression matches the output\. On failure, \fIUNEXPECTED\fR is displayed in addition\.
.
.IP
\fBNOTE:\fR Due to a bug in Bats, empty lines are discarded from \fB${lines[@]}\fR, causing line indices to change and preventing testing for empty lines\. See \fIBUGS\fR for more\.
.
.TP
\fBassert_success\fR
Fail if \fB$status\fR is not \fB0\fR\. On failure \fB$status\fR and \fB$output\fR are displayed\. If \fB$output\fR is longer than one line, it is displayed in \fImulit\-line\fR format\.
.
.TP
\fBassert_failure\fR [\fIEXPECTED\fR]
Fail if \fB$status\fR is \fB0\fR\. On failure \fB$output\fR is displayed\. If \fB$output\fR is longer than one line, it is displayed in \fImulit\-line\fR format\.
.
.IP
When \fIEXPECTED\fR is specified, fail if it does not equal \fB$status\fR\. On failure \fIEXPECTED\fR, \fB$status\fR and \fB$output\fR are displayed\.
.
.SH "BUGS"
.
.SS "Report bugs"
Report bugs on Bats\' GitHub issue tracker at \fIhttps://github\.com/sstephenson/bats/issues\fR\.
.
.SS "Known bugs"
Due to a bug in Bats, empty lines are missing from \fB${lines[@]}\fR, causing line indices to change and preventing testing for empty lines when using \fBassert_output\fR and \fBrefute_line\fR\. See PR #93 on Github at \fIhttps://github\.com/sstephenson/bats/pull/93\fR\.
.
.SH "COPYRIGHT"
TODO(ztombol): Find a suitable license\.
.
.SH "SEE ALSO"
\fBbash\fR(1), \fBbats\fR(1), \fBbats\fR(7), \fBregex(7)\fR
